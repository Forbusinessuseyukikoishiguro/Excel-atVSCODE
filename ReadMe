# Excel シート削除ツール

Excel ファイルから不要なシートを GUI で簡単に選択・削除できるPythonアプリケーションです。

## 📋 概要

- ✅ GUI でシートを視覚的に選択して削除
- ✅ バックアップファイルの作成（オプション）
- ✅ 安全な削除（最低1つのシートは保持）
- ✅ アクティブシートの識別
- ✅ 複数シートの一括削除

## 🖥️ システム要件

- **Python**: 3.7 以上
- **OS**: Windows, macOS, Linux
- **必要ライブラリ**: openpyxl, tkinter（標準ライブラリ）

## 📦 インストール

### 1. Pythonのインストール確認
```bash
python --version
```
Python 3.7以上がインストールされていることを確認してください。

### 2. 必要ライブラリのインストール
```bash
pip install openpyxl
```

### 3. ファイルのダウンロード
`excel_sheet_deleter_gui.py` をダウンロードまたは作成してください。

## 🚀 実行方法

### VS Code での実行

1. **VS Code でファイルを開く**
   ```
   excel_sheet_deleter_gui.py
   ```

2. **ターミナルを開く**
   - `Ctrl + Shift + `` (バッククォート) または
   - メニュー: `表示` → `ターミナル`

3. **プログラムを実行**
   ```bash
   python excel_sheet_deleter_gui.py
   ```

### コマンドプロンプトでの実行

1. **ファイルのあるフォルダに移動**
   ```bash
   cd C:\path\to\your\file
   ```

2. **実行**
   ```bash
   python excel_sheet_deleter_gui.py
   ```

### PowerShell での実行

1. **ファイルのあるフォルダに移動**
   ```powershell
   Set-Location "C:\path\to\your\file"
   ```

2. **実行**
   ```powershell
   python excel_sheet_deleter_gui.py
   ```

## 📖 使用方法

### 1. アプリケーションの起動
プログラムを実行すると、GUIウィンドウが開きます。

### 2. Excelファイルの選択
- **自動読み込み**: デフォルトで `C:\Users\yukik\Desktop\excel\test\sales_demo_data.xlsx` が読み込まれます
- **ファイル変更**: `参照` ボタンで別のファイルを選択可能
- **再読み込み**: `読み込み` ボタンでファイルを再読み込み

### 3. 削除するシートの選択
- ✅ **チェックボックス**: 削除したいシートにチェックを入れる
- 🔵 **アクティブシート**: 青色で表示される現在のアクティブシート
- 📝 **全選択/全解除**: 一括でシートを選択・解除

### 4. バックアップ設定
- 🔄 **バックアップチェック**: 削除前にバックアップファイルを作成
- 📁 **バックアップファイル**: `ファイル名_backup_YYYYMMDD_HHMMSS.xlsx` 形式で保存

### 5. 削除実行
1. `選択したシートを削除` ボタンをクリック
2. 確認ダイアログで内容を確認
3. `はい` で削除実行

## ⚡ 機能詳細

### 📊 ファイル情報表示
- シート数とファイルサイズをリアルタイム表示
- 削除後に自動更新

### 🛡️ 安全機能
- **最低1シート保持**: 全シート削除を防止
- **存在確認**: 指定されたシートの存在をチェック
- **確認ダイアログ**: 削除前に詳細確認

### 🎨 UI機能
- **スクロール対応**: 多数のシートがある場合に対応
- **ステータス表示**: 下部にリアルタイムステータス
- **視覚的フィードバック**: アクティブシートの強調表示

## 🚨 注意事項

### ⚠️ 重要な注意点
- **バックアップ推奨**: 重要なファイルは必ずバックアップを作成
- **権限確認**: ファイルの読み書き権限があることを確認
- **ファイル使用中**: Excelでファイルが開いていると操作できません

### 📝 対象ファイル形式
- ✅ `.xlsx` ファイル（推奨）
- ✅ `.xls` ファイル（対応）

### 🔒 制限事項
- 最低1つのシートは必須
- パスワード保護されたファイルは非対応
- 非常に大きなファイル（100MB以上）は動作が遅くなる場合があります

## 🔧 トラブルシューティング

### エラー: `ModuleNotFoundError: No module named 'openpyxl'`
**解決方法**:
```bash
pip install openpyxl
```

### エラー: ファイルが開けない
**考えられる原因**:
- ファイルパスが間違っている
- ファイルがExcelで開かれている
- 読み取り権限がない

**解決方法**:
- ファイルパスを確認
- Excelを閉じる
- 管理者権限で実行

### エラー: `'NoneType' object has no attribute 'title'`
**対応済み**: 最新版では修正されています

### GUI が表示されない
**確認事項**:
- tkinter が正しくインストールされているか
- ディスプレイの設定を確認

